---
TOCTitle: RMS Active Directory 缓存
Title: RMS Active Directory 缓存
ms:assetid: 'c721a2eb-2fe9-4346-b426-3cc169b97265'
ms:contentKeyID: 18112717
ms:mtpsurl: 'https://technet.microsoft.com/zh-cn/library/Cc747662(v=WS.10)'
---

RMS Active Directory 缓存
=========================

每个 RMS 根认证服务器或群集以及授权服务器都有一个本地 Active Directory 缓存，其中包含 Active Directory 全局编录组成员身份的查询结果。除每台服务器上的缓存之外，每个群集还有一个共享缓存，存储在目录服务数据库中。设置这些缓存的目的是为了减少提交给全局编录的查询数，并缩短响应授权请求的时间。

当用户请求用户许可证时，作出响应的服务器必须评估在发布许可证中是否已授予用户必需的权限。最简单的方法是，在发布许可证中明确对请求许可证的用户进行命名。但在许多情况下，作者是将权限授予组，而不是个别用户。

如果发布许可证没有明确命名发出请求的用户，而是将权限授予组，那么该服务器必须评估该用户的组成员身份，以确定该用户是否属于已获得权限的组。为此，服务器要向全局编录提交 LDAP 查询。

RMS 服务器将所有的组成员身份查询结果同时缓存到本地 Active Directory 缓存和群集目录服务数据库中。这样，服务器就可以从这些缓存中获取组成员身份的信息，从而减少其必须提交给全局编录的查询数。默认情况下对距离最近的服务器执行查询操作；但您也可以配置 GC 注册表项，以指定要查询的全局编录服务器。有关该设置的详细信息，请参阅本文档集中的“运行 RMS 服务器”中的“修改连接池注册表设置”。

要评估某个用户的组成员身份，服务器会先检查其缓存中是否已经存储了该用户的组成员身份信息。如果未找到相应信息，服务器会再检查群集的目录服务数据库。如果此数据库中也没有存储相应的组成员身份信息，则服务器将查询全局编录。

对于用户和组，缓存中包含以下 Active Directory 属性：

-   mail
-   ProxyAddresses（仅 SMTP 电子邮件地址）
-   objectSID
-   sidHistory
-   memberOf（用户或组所在组的 GUID）

本地 Active Directory 缓存中的项都带有时间戳。注册表设置指定了缓存中各项的有效期，以及可进行缓存的总项数。这些设置可能会影响服务器的性能。有关详细信息，请参阅本文档集中的“运行 RMS 服务器”中的“修改 Active Directory 缓存设置”。
